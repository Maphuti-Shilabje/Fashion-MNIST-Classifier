
# CSC3022F Machine Learning Assignment 1 - ANN for FashionMNIST

# Student Name: Maphuti Shilabje
# Student Number: SHLMAP001

## Description

This project implements a feedforward Artificial Neural Network (ANN) using Pytorch to classify images from the FashionMNIST dataset. The script (`classifier.py`) is designed to:

1.  Load the FashionMNIST dataset from local files.
2.  Define and build a configurable feedforward neural network.
3.  Train the network using the training dataset if no pre-trained model exists.
4.  Evaluate the trained network's accuracy on the test dataset.
5.  Save the trained model's parameters (`state_dict`) to a `.pth` file.
6.  Load a pre-trained model if one exists.
7.  Provide an interactive command-line interface allowing users to input the path to a JPEG image and receive a classification prediction from the trained model.
8.  Generate a `log.txt` file documenting the training loss per epoch and the final test accuracy from a training run.

## Dependencies

To run this script, you need the following installed:

*   Python 3.x
*   Pytorch (`torch`)
*   Torchvision (`torchvision`)
*   Pillow (`PIL`) - (Typically installed with Torchvision, but required for loading JPEG images)

You can usually install these using pip:
```bash
pip install torch torchvision pillow


(Note: Follow official Pytorch instructions for potential CUDA-enabled versions if you have a compatible GPU: https://pytorch.org/)

Dataset (FashionMNIST)

VERY IMPORTANT: This script will not download the FashionMNIST dataset automatically, as per assignment requirements (download=False is used).

You must obtain the FashionMNIST dataset files separately (e.g., from the Amathuba Resources page).

Place the entire FashionMNIST folder (which should contain the raw subfolder with files like train-images-idx3-ubyte.gz, t10k-labels-idx1-ubyte.gz, etc.) in the same directory as the classifier.py script.

The expected directory structure is:

your_project_folder/
├── classifier.py
├── README.md
├── log.txt             # Generated by the script
├── fashion_mnist_ann.pth # Generated by the script
├── .git/               # Your Git repository
└── FashionMNIST/         # <-- Dataset folder must be here!
    └── raw/
        ├── t10k-images-idx3-ubyte.gz
        ├── t10k-labels-idx1-ubyte.gz
        ├── train-images-idx3-ubyte.gz
        └── train-labels-idx1-ubyte.gz


classifier.py: The main Python script containing all the code for the ANN model definition, data loading, training, evaluation, saving/loading the model, and the interactive classifier loop.

README.md: This file, explaining the project and how to use it.

log.txt: A text file generated by classifier.py during a training run. It records the average training loss after each epoch and the final accuracy achieved on the test set for that run.

.git/: The local Git repository containing the version history of the project (required for submission).

fashion_mnist_ann.pth (Generated): This file stores the learned weights and biases (the state_dict) of the neural network after training. It is automatically generated by classifier.py upon completion of training and loaded if it exists when the script starts.

How to Run

Make sure all dependencies are installed (Python, Pytorch, Torchvision, Pillow).

Ensure the FashionMNIST dataset folder is correctly placed in the same directory as the script.

Navigate to the project directory in your terminal or command prompt.

Run the script using the Python interpreter:

python classifier.py
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
Bash
IGNORE_WHEN_COPYING_END

First Run / No Model File: If the fashion_mnist_ann.pth file is not present, the script will:

Load the FashionMNIST data.

Build the neural network model.

Train the model for the specified number of epochs, printing the average loss for each epoch.

Evaluate the trained model on the test set and print the final accuracy.

Save the trained model's state to fashion_mnist_ann.pth.

Generate/overwrite the log.txt file with the training details.

Proceed to the interactive classifier prompt.

Subsequent Runs / Model File Exists: If fashion_mnist_ann.pth is found, the script will:

Load the pre-trained model state from the file.

Skip the training and evaluation phases.

Proceed directly to the interactive classifier prompt.

Interactive Classifier Usage

After the training/loading phase, the script will enter an interactive loop:

Starting Evaluation...                # (Only if training just happened)
Accuracy on test set: XX.XX %        # (Only if training just happened)
Model saved to fashion_mnist_ann.pth # (Only if training just happened)
Loading existing model from fashion_mnist_ann.pth # (If model was loaded)

--- Interactive Classifier ---
Enter the path to a JPEG image or type 'exit' to quit.
Please enter a filepath:
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
IGNORE_WHEN_COPYING_END

Enter the relative path (e.g., images/my_sneaker.jpg) or absolute path to a grayscale JPEG (.jpg) image.

The script will load the image, preprocess it (using the same transforms as the training data), feed it to the loaded model, and print the predicted class name:

Classifier: Sneaker
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
IGNORE_WHEN_COPYING_END

The script will then prompt for another filepath.

To stop the program, type exit and press Enter.

log.txt File

This file serves as a record of a training session, fulfilling an assignment requirement. It contains:

The average training loss recorded after each epoch.

The final classification accuracy percentage achieved on the test set after the training completed.

Version Control

This project utilizes Git for version control from the start, as mandated by the assignment guidelines. The .git directory containing the repository history is included in this submission. Commit messages aim to be descriptive, and commits were made frequently during development.

